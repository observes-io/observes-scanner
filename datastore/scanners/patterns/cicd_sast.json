{
  "regex": {
    "name": "Script Patterns",
    "comment": "This is a collection of regex patterns used to identify alarming behaviors in pipelines. It is not exhaustive.",
    "lastUpdated": "2025-03-29",
    "patterns": [
      ".*git\\s+push\\s+https:\\/\\/.*",
      ".*git\\s+push\\s+--set-upstream.*",
      ".*git\\s+submodule\\s+add\\s+https:\\/\\/.*",
      ".*git\\s+clone\\s+https:\\/\\/.*",
      ".*git\\s+remote\\s+add\\s+.*",
      ".*git\\s+rebase\\s+-i.*",
      ".*git\\s+filter-branch\\s+--tree-filter.*",
      ".*ssh\\s+\\w+@.*",
      ".*scp\\s+.*",
      ".*rsync\\s+-\\w+\\s+.*",
      ".*curl\\s+.*https?:\\/\\/.*",
      ".*wget\\s+https?:\\/\\/.*",
      ".*ftp\\s+.*",
      ".*nc\\s+.*",
      ".*aws\\s+s3\\s+cp\\s+.*",
      ".*aws\\s+s3\\s+sync\\s+.*",
      ".*gcloud\\s+storage\\s+cp\\s+.*",
      ".*gcloud\\s+storage\\s+rsync\\s+.*",
      ".*az\\s+storage\\s+blob\\s+upload\\s+--account-name.*",
      ".*az\\s+storage\\s+blob\\s+upload-batch\\s+--source\\s+.*",
      ".*cat\\s+\\/etc\\/passwd.*",
      ".*cat\\s+~\\/\\.aws\\/credentials.*",
      ".*find\\s+\\/.*\\s+-name\\s+.*\\.(pem|key|crt|env|cfg).*",
      ".*grep\\s+-r\\s+\\\"\\w+(_KEY|_SECRET|_TOKEN|_PASSWORD).*",
      ".*echo\\s+.*(KEY|SECRET|TOKEN|PASSWORD).*",
      ".*ls\\s+-la\\s+~\\/\\.ssh.*",
      ".*ls\\s+-la\\s+~\\/\\.kube.*",
      ".*ls\\s+-la\\s+\\/root\\/\\.kube.*",
      ".*ls\\s+-la\\s+~\\/\\.azure.*",
      ".*ls\\s+-la\\s+~\\/\\.aws.*",
      ".*ls\\s+-la\\s+~\\/\\.gcp.*",
      ".*ls\\s+-la\\s+~\\/\\.terraform.*",
      ".*ls\\s+-la\\s+~\\/\\.docker.*",
      ".*ls\\s+-la\\s+~\\/\\.git.*",
      ".*ls\\s+-la\\s+~\\/\\.bash_history.*",
      ".*ls\\s+-la\\s+~\\/\\.bashrc.*",
      ".*ls\\s+-la\\s+~\\/\\.zsh_history.*",
      ".*ls\\s+-la\\s+~\\/\\.zshrc.*",
      ".*ls\\s+-la\\s+~\\/\\.bash_profile.*",
      ".*ls\\s+-la\\s+~\\/\\.profile.*",
      ".*bash\\s+-c\\s+\\[\\\".*\\\"\\]",
      ".*sh\\s+-c\\s+\\[\\\".*\\\"\\]",
      ".*python\\s+-c\\s+\\[\\\".*\\\"\\]",
      ".*perl\\s+-e\\s+\\[\\\".*\\\"\\]",
      ".*php\\s+-r\\s+\\[\\\".*\\\"\\]",
      ".*nc\\s+-e\\s+\\/bin\\/bash.*",
      ".*bash\\s+-i\\s+>&\\s+\\/dev\\/tcp\\/.*",
      ".*perl\\s+-e\\s+\\[\\\".*\\/dev\\/tcp\\/.*\\\"\\]",
      ".*python\\s+-c\\s+\\[\\\"import\\s+socket.*socket\\.connect.*\\\"\\]",
      ".*rm\\s+-rf\\s+\\/opt\\/security-agent.*",
      ".*kill\\s+-9\\s+\\$?\\(pgrep\\s+\\w+\\).*",
      ".*docker\\s+run\\s+-d\\s+--privileged\\s+.*",
      ".*docker\\s+run\\s+-v\\s+\\/var\\/run\\/docker.sock:/var\\/run\\/docker.sock.*",
      ".*docker\\s+cp\\s+\\w+:\\/etc\\/passwd.*",
      ".*kubectl\\s+exec\\s+-it\\s+\\w+\\s+--\\s+\\/bin\\/sh.*",
      ".*kubectl\\s+cp\\s+\\w+:\\/etc\\/passwd.*",
      ".*kubectl\\s+logs\\s+.*",
      ".*kubectl\\s+exec\\s+-it\\s+\\w+\\s+--\\s+.*",
      ".*export\\s+\\w+_KEY=.*",
      ".*openssl\\s+base64\\s+-e\\s+-in\\s+.*",
      ".*aws\\s+secretsmanager\\s+get-secret-value.*",
      ".*gcloud\\s+secrets\\s+versions\\s+access\\s+.*",
      ".*az\\s+keyvault\\s+secret\\s+download.*",
      ".*base64\\s+.*",
      ".*openssl\\s+enc\\s+-aes-\\w+\\s+-in\\s+.*\\s+-out\\s+.*",
      ".*dd\\s+if=\\/dev\\/.*\\s+of=.*",
      ".*tr\\s+-d\\s+\\\"\\s+.*",
      ".*sed\\s+-e\\s+.*",
      ".*xxd\\s+-r\\s+.*",
      ".*chmod\\s+777\\s+.*",
      ".*chown\\s+root\\s+.*",
      ".*mail\\s+-s\\s+\\\".*\\\"\\s+.*@.*"
    ]
  }
}
